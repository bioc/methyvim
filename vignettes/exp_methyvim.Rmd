---
title: "Targeted Learning of Differential Methylation from Exposures"
author: "Nima Hejazi"
date: "`r Sys.Date()`"
output:
  BiocStyle::html_document
bibliography: vignette-refs.bib
vignette: >
  %\VignetteIndexEntry{Targeted Learning of Differential Methylation from Exposures}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

## Introduction

...

---

## Preliminaries

```{r reqs, echo=FALSE}
suppressMessages(library(tmle))
suppressMessages(library(minfi))
suppressMessages(library(SummarizedExperiment))
```

First, we'll load the `methyvim` package and the example data contained in the
`methyvimData` package that accompanies it:

```{r prelims}
library(methyvim)
library(methyvimData)
```

Now, let's load the data set and seed the RNG:

```{r get-data}
data(grsExample)
set.seed(479253)
grsExample
```

The example data object is of class `GenomicRatioSet` from the `minfi` package.
The summary provided by the `print` method gives a wealth of information on the
experiment that generated the data. While most slots of objects of this S4 class
have descriptive names, the interested analyst might consider consulting the
documentation of the `minfi` package for an in-depth description _(cite minfi)_.

---

## Quantifying the Effect of an Exposure on DNA Methylation

### The Average Treatment Effect as Variable Importance Measure

...

```{r methyvim-ate}
methyvim_out_ate <- methyvim(data_grs = grsExample, sites_comp = 10,
                             var_int = 1, vim = "ate", type = "Mval",
                             filter = "limma", filter_cutoff = 0.05,
                             parallel = FALSE, tmle_type = "sl"
                            )
methyvim_out_ate
```

As is clear from examining the object `methyvim_out_ate`, the output resembles
exactly that returned when examining objects of class `GenomicRatioSet` from the
`minfi` R package. In particular, the object returned is merely a modified form
of the input `GenomicRatioSet` object -- thus, it contains all of the original
slots, with all data intact. Several extra pieces of information are contained
within the output object as well _(cite minfi)_.

We can take a look at the results produced from the estimation procedure by
examining the `"vim"` `slot` of the `methytmle` object:

```{r methyvim-ate-print}
head(slot(methyvim_out_ate, "vim"))
```

...

```{r methyvim-ate-plot-volcano}
plot(methyvim_out_ate, type = "volcano")
```

...

```{r methyvim-ate-plot-pvals}
plot(methyvim_out_ate, type = "pvals")
```

...

### The Risk Ratio as Variable Importance Measure

...

```{r methyvim-rr}
methyvim_out_rr <- methyvim(data_grs = grsExample, sites_comp = 10,
                            var_int = 1, vim = "rr", type = "Mval",
                            filter = "limma", filter_cutoff = 0.05,
                            parallel = FALSE, tmle_type = "sl"
                           )
methyvim_out_rr
```
...

```{r methyvim-rr-print}
head(slot(methyvim_out_rr, "vim"))
```
...

```{r methyvim-rr-plot-volcano, eval=FALSE}
plot(methyvim_out_rr, type = "volcano")
```

...


```{r methyvim-rr-plot-pvals, eval=FALSE}
plot(methyvim_out_rr, type = "pvals")
```

...

---

## Session Information

```{r session-info, echo=FALSE}
sessionInfo()
```

---

## References
