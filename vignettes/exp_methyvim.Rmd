---
title: "Targeted Learning of Differential Methylation from Exposures"
author: "Nima Hejazi"
date: "`r Sys.Date()`"
output:
  BiocStyle::html_document
bibliography: vignette-refs.bib
vignette: >
  %\VignetteIndexEntry{Targeted Learning of Differential Methylation from Exposures}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

## Introduction

...

---

## Preliminaries

```{r reqs, echo=FALSE}
suppressMessages(library(minfi))
suppressMessages(library(SummarizedExperiment))
suppressMessages(library(tmle))
```

First, we'll load the `methyvim` package and the example data contained in the
`methyvimData` package that accompanies it:

```{r prelims}
library(methyvim)
library(methyvimData)
```

Now, let's load the data set and seed the RNG:

```{r get-data}
data(grsExample)
set.seed(479253)
grsExample
```

---

## Quantifying the Effect of an Exposure on DNA Methylation

### The Average Treatment Effect as Variable Importance Measure

...

```{r methyvim-ate}
methyvim_out_ate <- methyvim(data_grs = grsExample, sites_comp = 10,
                             var_int = 1, vim = "ate", type = "Mval",
                             filter = "limma", filter_cutoff = 0.05,
                             parallel = FALSE, tmle_type = "sl"
                            )
methyvim_out_ate
```
...

```{r methyvim-ate-print}
#head(methyvim_out_ate)
```

...

```{r methyvim-ate-plot-volcano}
#plot(methyvim_out_ate, type = "volcano")
```

...

```{r methyvim-ate-plot-heatmap}
#plot(methyvim_out_ate, type = "heatmap")
```

...

```{r methyvim-ate-plot-pvals}
#plot(methyvim_out_ate, type = "pvals")
```

...

### The Risk Ratio as Variable Importance Measure

...

```{r methyvim-rr}
methyvim_out_rr <- methyvim(data_grs = grsExample, sites_comp = 10,
                            var_int = 1, vim = "rr", type = "Mval",
                            filter = "limma", filter_cutoff = 0.05,
                            parallel = FALSE, tmle_type = "sl"
                           )
methyvim_out_rr
```
...

```{r methyvim-rr-print}
#head(methyvim_out_rr)
```
...

```{r methyvim-rr-plot-volcano}
#plot(methyvim_out_rr, type = "volcano")
```

...

```{r methyvim-rr-plot-heatmap}
#plot(methyvim_out_rr, type = "heatmap")
```

...

```{r methyvim-rr-plot-pvals}
#plot(methyvim_out_rr, type = "pvals")
```

...

---

## Session Information

```{r session-info, echo=FALSE}
sessionInfo()
```

---

## References

