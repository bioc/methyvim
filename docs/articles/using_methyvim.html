<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Targeted Data-Adaptive Estimation and Inference for Differential Methylation Analysis • methyvim</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Targeted Data-Adaptive Estimation and Inference for Differential Methylation Analysis">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">methyvim</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.9.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/using_methyvim.html">Targeted Data-Adaptive Estimation and Inference for Differential Methylation Analysis</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/nhejazi/methyvim">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Targeted Data-Adaptive Estimation and Inference for Differential Methylation Analysis</h1>
                        <h4 class="author">Nima Hejazi</h4>
            
            <h4 class="date">2019-10-31</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/nhejazi/methyvim/blob/master/vignettes/using_methyvim.Rmd"><code>vignettes/using_methyvim.Rmd</code></a></small>
      <div class="hidden name"><code>using_methyvim.Rmd</code></div>

    </div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      We present a general algorithm for the nonparametric estimation of effects of DNA methylation at CpG sites scattered across the genome, complete with honest statistical inference for such estimates. This approach leverages variable importance measures, a class of parameters that arise in the study of causal inference. The parameters we present are defined in such a manner that they provide targeted estimates of the relative importance of CpG sites in the case of binary exposures/treatments assigned at the level of subjects. Such parameters come equipped with rich scientific interpretations, providing an avenue to move beyond linear models, applying modern developments in machine learning to estimating quantities of scientific interest in computational biology.
    </div>
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>DNA methylation is a fundamental epigenetic process known to play an important role in the regulation of gene expression. DNA CpG methylation involves the addition of a methyl group (<span class="math inline">\(\text{CH}_3\)</span>) to the fifth carbon of the cytosine ring structure to form 5-methylcytosine. Numerous biological and medical studies have implicated DNA CpG methylation as playing a role in disease and development <span class="citation">(Robertson 2005)</span>. Perhaps unsurprisingly then, biotechnologies have been developed to study the molecular mechanisms of this epigenetic process. Modern assays, like the Illumina <em>Infinium</em> Methylation assay, allow for quantitative interrogation of DNA methylation of CpG sites scattered across the genome at single-nucleotide resolution; moreover, much effort has been invested, by the bioinformatics community, in the development of tools for properly removing technological effects that may contaminate biological signatures measured by such assays. Despite these advances in both biological and bioninformatical techniques, most statistical methods available for the analysis of data produced by such assays rely on over-simplified (often generalized linear) models.</p>
<p>Here, we present an alternative to such statistical analysis approaches, in the form of nonparametric estimation procedures inspired by machine learning and causal inference. Specifically, we provide a technique for obtaining estimates of nonparametric <em>variable importance measures</em> (<strong>VIM</strong>), parameters with rich scientific interpretations under the standard (untestable) assumptions used in statistical causal inference, defining a limited set of VIMs specifically with respect to the type of data commonly produced by DNA methylation assays. For VIMs defined in such a manner, targeted minimum loss-based estimates may be readily computed based on the data made available by DNA methylation assays. Our contribution, <code>methyvim</code> is an R package that provides facilities for performing differential methylation analyses within exactly this scope.</p>
<p>As the substantive contribution of our work is an estimation procedure, we focus on data produced by 450k and 850k (EPIC) arrays made by Illumina and assume that data has been subjected to proper quality control and normalizaton procedures, as outlined by others in the computational biology community <span class="citation">(Fortin et al. 2014, <span class="citation">@dedeurwaerder2013comprehensive</span>)</span>. For a general discussion of the framework of targeted minimum loss-based estimation and the role this approach plays in statistical causal inference, the interested reader is invited to consult <span class="citation">van der Laan and Rose (2011)</span> and <span class="citation">van der Laan and Rose (2018)</span>. For a more general introduction to statistical causal inference, <span class="citation">Pearl (2000)</span> serves well.</p>
<hr>
</div>
<div id="methodology" class="section level2">
<h2 class="hasAnchor">
<a href="#methodology" class="anchor"></a>Methodology</h2>
<p>The core functionality of this package is made available via the eponymous <code>methyvim</code> function, which implements a statistical algorithm designed to compute targeted estimates of VIMs, defined in such a way that the VIMs represent parameters of scientific interest in computational biology experiments; moreover, these VIMs are defined such that they may be estimated in a manner that is very nearly assumption-free, that is, within a <em>fully nonparametric statistical model</em>. <strong>The statistical algorithm consists in several major steps:</strong></p>
<ol style="list-style-type: decimal">
<li><p>Pre-screening of genomic sites is used to isolate a subset of sites for which there is cursory evidence of differential methylation. For the sake of computational feasibility, targeted minimum loss-based estimates of VIMs are computed only for this subset of sites. Currently, the available screening approach adapts core routines from the <a href="http://bioconductor.org/packages/limma"><code>limma</code></a> R package. Future releases will support functionality from other packages (e.g., <a href="https://CRAN.R-project.org/package=randomForest"><code>randomForest</code></a>, <a href="https://CRAN.R-project.org/package=tmle.npvi"><code>tmle.npvi</code></a>). Following the style of the function for performing screening via <code>limma</code>, users may write their own screening functions and are invited to contribute such functions to the core software package by opening pull requests at the GitHub repository.</p></li>
<li><p>Nonparametric estimates of VIMs, for the specified target parameter, are computed at each of the CpG sites passing the screening step. The VIMs are defined in such a way that the estimated effects is of an exposure/treatment on the methylation status of a target CpG site, controlling for the observed methylation status of the neighbors of that site. Currently, routines are adapted from the <a href="https://CRAN.R-project.org/package=tmle"><code>tmle</code></a> R package. Future releases will support doubly-robust estimates of these VIMs (via the <a href="https://CRAN.R-project.org/package=drtmle"><code>drtmle</code></a> package) and add parameters for continuous treatments/exposures (via the <a href="https://CRAN.R-project.org/package=tmle.npvi"><code>tmle.npvi</code></a> package).</p></li>
<li><p>Since pre-screening is performed prior to estimating VIMs, we make use of a multiple testing correction uniquely suited to such settings. Due to the multiple testing nature of the estimation problem, a variant of the Benjamini &amp; Hochberg procedure for controlling the False Discovery Rate (FDR) is applied <span class="citation">(Benjamini and Hochberg 1995)</span>. Specifically, we apply the “modified marginal Benjamini &amp; Hochberg step-up False Discovery Rate controlling procedure for multi-stage analyses” (FDR-MSA), which is guaranteed to control the FDR as if all sites were tested (i.e., without screening) <span class="citation">(Tuglus and van der Laan 2009)</span>.</p></li>
</ol>
<hr>
</div>
<div id="parameters-of-interest" class="section level2">
<h2 class="hasAnchor">
<a href="#parameters-of-interest" class="anchor"></a>Parameters of Interest</h2>
<p>For discrete-valued treatments or exposures:</p>
<ul>
<li><p>The <em>average treatment effect</em> (ATE): The effect of a binary exposure or treatment on the observed methylation at a target CpG site is estimated, controlling for the observed methylation at all other CpG sites in the same neighborhood as the target site, based on an additive form. In particular, the parameter estimate represents the <strong>additive difference</strong> in methylation that would have been observed at the target site had all observations received the treatment versus the counterfactual under which none received the treatment.</p></li>
<li><p>The <em>relative risk</em> (RR): The effect of a binary exposure or treatment on the observed methylation at a target CpG site is estimated, controlling for the observed methylation at all other CpG sites in the same neighborhood as the target site, based on a geometric form. In particular, the parameter estimate represents the <strong>multiplicative difference</strong> in methylation that would have been observed at the target site had all observations received the treatment versus the counterfactual under which none received the treatment.</p></li>
</ul>
<p>Support for continuous-valued treatments or exposures is <em>planned but not yet available</em>, though work is underway to incorporate into our methodology the following</p>
<ul>
<li>A <em>nonparametric variable importance measure</em> (NPVI) <span class="citation">(Chambaz, Neuvial, and van der Laan 2012)</span>: The effect of continuous-valued exposure or treatment (the observed methylation at a target CpG site) on an outcome of interest is estimated, controlling for the observed methylation at all other CpG sites in the same neighborhood as the target (treatment) site, based on a parameter that compares values of the treatment against a reference value taken to be the null. In particular, the implementation provided is designed to assess the effect of differential methylation at the target CpG site on a (typically) phenotype-level outcome of interest (e.g., survival), in effect providing an nonparametric evaluation of the impact of methylation at the target site on said outcome.</li>
</ul>
<p><em>As previously noted, in all cases, an estimator of the target parameter is constructed via targeted minimum loss-based estimation.</em></p>
<p>Having now discussed the foundational principles of the estimation procedure employed and the statistical algorithm implemented, it is best to proceed by examining <code>methyvim</code> by example.</p>
<hr>
</div>
<div id="preliminaries-setting-up-the-data" class="section level2">
<h2 class="hasAnchor">
<a href="#preliminaries-setting-up-the-data" class="anchor"></a>Preliminaries: Setting up the Data</h2>
<p>First, we’ll load the <code>methyvim</code> package and the example data contained in the <code>methyvimData</code> package that accompanies it:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(methyvim)</a></code></pre></div>
<pre><code>## methyvim v1.9.0: Targeted, Robust, and Model-free Differential Methylation Analysis</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(methyvimData)</a></code></pre></div>
<p>Now, let’s load the data set and seed the RNG:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">479253</span>)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(grsExample)</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">grsExample</a></code></pre></div>
<pre><code>## class: GenomicRatioSet 
## dim: 400 210 
## metadata(0):
## assays(2): Beta M
## rownames(400): cg23578515 cg06747907 ... cg01715842 cg09895959
## rowData names(0):
## colnames(210): V2 V3 ... V397 V398
## colData names(2): exp outcome
## Annotation
##   array: IlluminaHumanMethylationEPIC
## Preprocessing
##   Method: NA
##   minfi version: NA
##   Manifest version: NA</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">var_int &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="kw">colData</span>(grsExample)[, <span class="dv">1</span>])</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/table.html">table</a></span>(var_int)</a></code></pre></div>
<pre><code>## var_int
##   0   1 
## 105 105</code></pre>
<p>The example data object is of class <code>GenomicRatioSet</code>, provided by the <code>minfi</code> package. The summary provided by the <code>print</code> method gives a wealth of information on the experiment that generated the data – since we are working with a simulated data set, we need not concern ourselves with much of this information.</p>
<p>We can create an object of class <code>methytmle</code> from any <code>GenomicRatioSet</code> object simply invoking the S4 class constructor:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">mtmle &lt;-<span class="st"> </span><span class="kw"><a href="../reference/methytmle-class.html">.methytmle</a></span>(grsExample)</a></code></pre></div>
<p>Since the <code>methytmle</code> class builds upon the <code>GenomicRatioSet</code> class, it contains all of the slots of <code>GenomicRatioSet</code>. The new class introduced in the <code>methyvim</code> package includes several new slots:</p>
<ul>
<li>
<code>call</code> - the form of the original call to the <code>methyvim</code> function.</li>
<li>
<code>screen_ind</code> - indices identifying CpG sites that pass the screening process.</li>
<li>
<code>clusters</code> - non-unique IDs corresponding to the manner in wich sites are treated as neighbors. These are assigned by genomic distance (bp) and respect chromosome boundaries (produced via a call to <code><a href="https://rdrr.io/pkg/bumphunter/man/clusterMaker.html">bumphunter::clusterMaker</a></code>).</li>
<li>
<code>var_int</code> - the treatment/exposure status for each subject. Currently, these must be binary, due to the definition of the supported targeted parameters.</li>
<li>
<code>param</code> - the name of the target parameter from which the estimated VIMs are defined.</li>
<li>
<code>vim</code> - a table of statistical results obtained from estimating VIMs for each of the CpG sites that pass the screening procedure.</li>
<li>
<code>ic</code> - the measured array values for each of the CpG sites passing the screening, transformed into influence curve space based on the chosen target parameter.</li>
</ul>
<p>The interested analyst might consider consulting the documentation of the <code>minfi</code> package for an in-depth description of all of the other slots that appear in this class <span class="citation">(Aryee et al. 2014)</span>. Having examined the core structure of the package, it is time now to discuss the analytic capabilities implemented.</p>
<hr>
</div>
<div id="differential-methylation-based-on-a-binary-treatment-or-exposure" class="section level2">
<h2 class="hasAnchor">
<a href="#differential-methylation-based-on-a-binary-treatment-or-exposure" class="anchor"></a>Differential Methylation Based on a Binary Treatment or Exposure</h2>
<div id="the-average-treatment-effect-as-variable-importance-measure" class="section level3">
<h3 class="hasAnchor">
<a href="#the-average-treatment-effect-as-variable-importance-measure" class="anchor"></a>The Average Treatment Effect as Variable Importance Measure</h3>
<p>The average treatment effect (ATE) is a canonical parameter that arises in statistical causal inference, often denoted <span class="math inline">\(\psi_0 = \psi_0(1) - \psi_0(0)\)</span>, representing the difference in an outcome between the counterfactuals under which all subjects received the treatment/exposure and under which none received such treatment/exposure. Under additional (untestable) assumptions, this parameter has a richer interpretation as a mean counterfactual outcome, wherein the counterfactuals used in this definition define causal effects. When causal assumptions remain unfulfilled or untested, this parameter may still be estimated in the form of a nonparametric VIM.</p>
<p>Estimating such the VIM corresponding to such a parameter requires two separate regression steps: one for the treatment mechanism (propensity score) and one for the outcome regression. Technical details on the nature of these regressions are discussed in <span class="citation">Hernan and Robins (2019)</span>, and details for estimating these regressions in the framework of targeted minimum loss-based estimation are discussed in <span class="citation">van der Laan and Rose (2011)</span>.</p>
<div id="super-learning-for-nonparametric-parameter-estimation" class="section level4">
<h4 class="hasAnchor">
<a href="#super-learning-for-nonparametric-parameter-estimation" class="anchor"></a>Super Learning for nonparametric parameter estimation</h4>
<p>Nonparametric and data-adaptive regressions (i.e., machine learning) may be used in the two regression steps outlined above. This is implemented using the super learner algorithm, which produces optimal combinations of such regression functions (a variant of stacked regressions) using cross-validation <span class="citation">(van der Laan, Polley, and Hubbard 2007, <span class="citation">@breiman1996stacked</span>, <span class="citation">@wolpert1992stacked</span>)</span>.</p>
<p><code>methyvim</code> makes performing such estimation for CpG sites using a given VIM essentially trivial:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/message.html">suppressMessages</a></span>(</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">  methyvim_ate_sl &lt;-<span class="st"> </span><span class="kw"><a href="../reference/methyvim.html">methyvim</a></span>(<span class="dt">data_grs =</span> grsExample, <span class="dt">sites_comp =</span> <span class="dv">25</span>,</a>
<a class="sourceLine" id="cb9-3" data-line-number="3">                              <span class="dt">var_int =</span> var_int, <span class="dt">vim =</span> <span class="st">"ate"</span>, <span class="dt">type =</span> <span class="st">"Mval"</span>,</a>
<a class="sourceLine" id="cb9-4" data-line-number="4">                              <span class="dt">filter =</span> <span class="st">"limma"</span>, <span class="dt">filter_cutoff =</span> <span class="fl">0.10</span>,</a>
<a class="sourceLine" id="cb9-5" data-line-number="5">                              <span class="dt">parallel =</span> <span class="ot">FALSE</span>, <span class="dt">tmle_type =</span> <span class="st">"sl"</span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6">                             )</a>
<a class="sourceLine" id="cb9-7" data-line-number="7">)</a></code></pre></div>
<pre><code>## Warning in set_parallel(parallel = parallel, future_param = future_param, :
## Sequential evaluation over many probes may take a long time.</code></pre>
<p>As is clear from examining the object <code>methyvim_ate_sl</code>, the output resembles exactly that returned when examining objects of class <code>GenomicRatioSet</code> from the <code>minfi</code> R package. In particular, the returned <code>methytmle</code> object is merely a modified form (in particular, a subclass) of the input <code>GenomicRatioSet</code> object – thus, it contains all of the original slots, with all of the experimental data intact. Several extra pieces of information are contained within the output object as well_.</p>
<p>We can take a look at the results produced from the estimation procedure (stored in the <code>vim</code> <code>slot</code> of the <code>methytmle</code> object) simply by invoking the custom S4 accessor function <code>vim</code> (note that the <code>show</code> method of the resultant object also displays this same information, amongst other things):</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw"><a href="../reference/methytmle-class.html">vim</a></span>(methyvim_ate_sl)</a></code></pre></div>
<pre><code>##                lwr_ci    est_ate     upr_ci   var_ate         pval
## cg22913481  -2.241046 -0.5738109  1.0934239 0.7235714 4.999479e-01
## cg15131207  -1.414328 -0.4633953  0.4875377 0.2353898 3.395171e-01
## cg10613282  -2.230081 -0.8691549  0.4917713 0.4821220 2.106598e-01
## cg15857610  -2.044781 -0.2695842  1.5056124 0.8203152 7.659713e-01
## cg24775884  -3.749987  0.5128954  4.7757779 4.7303641 8.135720e-01
## cg22954484  -2.570027  0.6063534  3.7827334 2.6263510 7.082903e-01
## cg23076894  -5.761423 -0.4517812  4.8578604 7.3386853 8.675507e-01
## cg07697276  -3.079394 -0.7915787  1.4962367 1.3624790 4.976732e-01
## cg01674119  -2.517292 -1.0973701  0.3225520 0.5248279 1.298325e-01
## cg02749733  -1.883485 -0.8608829  0.1617195 0.2722084 9.893564e-02
## cg12742764  -8.686076 -4.4381324 -0.1901884 4.6972689 4.058422e-02
## cg15396367 -10.948696 -5.4022936  0.1441086 8.0077512 5.625247e-02
## cg18233010  -8.446659 -4.3621161 -0.2775733 4.3428492 3.633168e-02
## cg01532849  -6.020016 -2.6830751  0.6538663 2.8985781 1.150391e-01
## cg24268444  -6.977900 -3.5516457 -0.1253913 3.0558151 4.218095e-02
## cg10560245  -4.537997 -2.0915700  0.3548566 1.5579455 9.379696e-02
## cg20185936  -6.528386 -3.3249208 -0.1214552 2.6713328 4.192027e-02
## cg06714180  -1.905104 -1.2702925 -0.6354814 0.1049003 8.779157e-05
## cg15817960  -0.998158 -0.1084321  0.7812938 0.2060632 8.112081e-01
## cg15611151  -1.674590 -0.6383086  0.3979726 0.2795394 2.273231e-01
## cg00567703  -1.643306 -0.7310898  0.1811269 0.2166127 1.162225e-01
## cg01609275  -1.675129 -0.6567175  0.3616940 0.2699818 2.062673e-01
## cg00058576  -3.259925  0.3561932  3.9723111 3.4038704 8.469096e-01
## cg26992600  -3.346484 -0.2549158  2.8366523 2.4879721 8.716113e-01
## cg12172984  -2.077834  1.5873883  5.2526103 3.4969421 3.959561e-01
##            n_neighbors n_neighbors_control max_cor_neighbors
## cg22913481           0                   0                NA
## cg15131207           0                   0                NA
## cg10613282           0                   0                NA
## cg15857610           5                   4        0.77207047
## cg24775884           5                   2        0.88975664
## cg22954484           5                   2        0.86439358
## cg23076894           5                   1        0.88975664
## cg07697276           5                   2        0.84238389
## cg01674119           5                   5        0.61874408
## cg02749733           0                   0                NA
## cg12742764           8                   2        0.90569752
## cg15396367           8                   2        0.90569752
## cg18233010           8                   2        0.88601655
## cg01532849           8                   2        0.89423768
## cg24268444           8                   2        0.89690199
## cg10560245           8                   2        0.86644061
## cg20185936           8                   2        0.87376499
## cg06714180           8                   8       -0.09301902
## cg15817960           8                   8        0.40419875
## cg15611151           7                   7        0.13851867
## cg00567703           7                   7        0.13851867
## cg01609275           7                   7        0.20795189
## cg00058576           7                   4        0.88568207
## cg26992600           7                   4        0.85605741
## cg12172984           7                   4        0.87356095</code></pre>
<p>From the table displayed, we note that we have access to point estimates of the ATE (“est_ate”) as well as lower and upper confidence interval bounds for each estimate (“lwr_ci” and “upr_ci”, respectively). Additional statistical information we have access to include the variance (“var_ate”) of the estimate as well as the p-value (“pval”) associated with each point estimate (based on Wald-style testing procedures). Beyond these, key bioinformatical quantities, with respect to the algorithm outlined above, are also returned; these include the total number of neighbors of the target site (“n_neighbors”), the number of neighboring sites controlled for when estimating the effect of exposure on DNA methylation (“n_neighbors_control”), and, the maximum correlation between the target site and any given site in its full set of neighbors (“max_cor_neighbors”).</p>
</div>
<div id="generalized-linear-models-for-parameter-estimation" class="section level4">
<h4 class="hasAnchor">
<a href="#generalized-linear-models-for-parameter-estimation" class="anchor"></a>Generalized linear models for parameter estimation</h4>
<p>In cases where nonparametric regressions may not be preferred (e.g., where time constraints are of concern), generalized linear models (GLMs) may be used to fit the two regression steps required for estimating VIMs for the ATE.</p>
<p><code>methyvim</code> makes performing such estimation for CpG sites using a given VIM essentially trivial:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/message.html">suppressMessages</a></span>(</a>
<a class="sourceLine" id="cb13-2" data-line-number="2">  methyvim_ate_glm &lt;-<span class="st"> </span><span class="kw"><a href="../reference/methyvim.html">methyvim</a></span>(<span class="dt">data_grs =</span> grsExample, <span class="dt">sites_comp =</span> <span class="dv">25</span>,</a>
<a class="sourceLine" id="cb13-3" data-line-number="3">                               <span class="dt">var_int =</span> var_int, <span class="dt">vim =</span> <span class="st">"ate"</span>, <span class="dt">type =</span> <span class="st">"Mval"</span>,</a>
<a class="sourceLine" id="cb13-4" data-line-number="4">                               <span class="dt">filter =</span> <span class="st">"limma"</span>, <span class="dt">filter_cutoff =</span> <span class="fl">0.10</span>,</a>
<a class="sourceLine" id="cb13-5" data-line-number="5">                               <span class="dt">parallel =</span> <span class="ot">FALSE</span>, <span class="dt">tmle_type =</span> <span class="st">"glm"</span></a>
<a class="sourceLine" id="cb13-6" data-line-number="6">                              )</a>
<a class="sourceLine" id="cb13-7" data-line-number="7">)</a></code></pre></div>
<pre><code>## Warning in set_parallel(parallel = parallel, future_param = future_param, :
## Sequential evaluation over many probes may take a long time.</code></pre>
<p>Just as before, we can take a look at the results produced from the estimation procedure (stored in the <code>vim</code> <code>slot</code> of the <code>methytmle</code> object) simply by invoking the custom S4 accessor function <code>vim</code> (note that the <code>show</code> method of the resultant object also displays this same information, amongst other things):</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw"><a href="../reference/methytmle-class.html">vim</a></span>(methyvim_ate_glm)</a></code></pre></div>
<pre><code>##                 lwr_ci     est_ate      upr_ci   var_ate         pval
## cg22913481  -2.2737329 -0.61095578  1.05182129 0.7197073 4.714236e-01
## cg15131207  -1.4052652 -0.46187188  0.48152148 0.2316720 3.372626e-01
## cg10613282  -2.2542647 -0.88585344  0.48255779 0.4874399 2.045039e-01
## cg15857610  -2.4325450 -0.48107089  1.47040317 0.9913190 6.289731e-01
## cg24775884  -3.3747760  1.07346950  5.52171503 5.1506894 6.362164e-01
## cg22954484  -2.0920242  1.08070264  4.25342943 2.6203132 5.043759e-01
## cg23076894  -5.7167079 -0.50400813  4.70869167 7.0731568 8.496935e-01
## cg07697276  -2.8678982 -0.52591073  1.81607675 1.4277659 6.598411e-01
## cg01674119  -2.4613602 -0.90544317  0.65047384 0.6301743 2.540392e-01
## cg02749733  -1.8923030 -0.87365602  0.14499097 0.2701066 9.275906e-02
## cg12742764  -8.8892360 -4.56431555 -0.23939514 4.8690485 3.859389e-02
## cg15396367 -10.0395853 -4.28710706  1.46537120 8.6138604 1.440937e-01
## cg18233010  -8.1404001 -3.88759842  0.36520322 4.7080179 7.318299e-02
## cg01532849  -6.2097167 -2.80064889  0.60841887 3.0252351 1.073548e-01
## cg24268444  -6.8848141 -3.45993270 -0.03505126 3.0533665 4.769687e-02
## cg10560245  -4.3925622 -1.98734363  0.41787495 1.5059029 1.053449e-01
## cg20185936  -6.2100752 -3.05038976  0.10929566 2.5988161 5.846404e-02
## cg06714180  -1.9161920 -1.27931242 -0.64243279 0.1055851 8.247573e-05
## cg15817960  -0.9821399 -0.08687332  0.80839327 0.2086376 8.491594e-01
## cg15611151  -1.6895107 -0.64225180  0.40500713 0.2854934 2.293605e-01
## cg00567703  -1.5560011 -0.65512297  0.24575516 0.2112613 1.540643e-01
## cg01609275  -1.5946467 -0.61958346  0.35547977 0.2474876 2.129697e-01
## cg00058576  -4.0047990 -0.17636854  3.65206191 3.8153060 9.280540e-01
## cg26992600  -4.6156645 -1.30503285  2.00559882 2.8530513 4.397466e-01
## cg12172984  -3.8585666  0.26942032  4.39740728 4.4357237 8.982100e-01
##            n_neighbors n_neighbors_control max_cor_neighbors
## cg22913481           0                   0                NA
## cg15131207           0                   0                NA
## cg10613282           0                   0                NA
## cg15857610           5                   4        0.77207047
## cg24775884           5                   2        0.88975664
## cg22954484           5                   2        0.86439358
## cg23076894           5                   1        0.88975664
## cg07697276           5                   2        0.84238389
## cg01674119           5                   5        0.61874408
## cg02749733           0                   0                NA
## cg12742764           8                   2        0.90569752
## cg15396367           8                   2        0.90569752
## cg18233010           8                   2        0.88601655
## cg01532849           8                   2        0.89423768
## cg24268444           8                   2        0.89690199
## cg10560245           8                   2        0.86644061
## cg20185936           8                   2        0.87376499
## cg06714180           8                   8       -0.09301902
## cg15817960           8                   8        0.40419875
## cg15611151           7                   7        0.13851867
## cg00567703           7                   7        0.13851867
## cg01609275           7                   7        0.20795189
## cg00058576           7                   4        0.88568207
## cg26992600           7                   4        0.85605741
## cg12172984           7                   4        0.87356095</code></pre>
<p><em>Remark:</em> Here, the estimates are obtained via GLMs, making each of the regression steps less robust than if nonparametric regressions were used. It is expected that these estimates differ from those obtained previously.</p>
<hr>
</div>
</div>
<div id="the-risk-ratio-as-variable-importance-measure" class="section level3">
<h3 class="hasAnchor">
<a href="#the-risk-ratio-as-variable-importance-measure" class="anchor"></a>The Risk Ratio as Variable Importance Measure</h3>
<p>The risk ratio (RR) is another popular parameter that arises in statistical causal inference, denoted <span class="math inline">\(\psi_0 = \frac{\psi_0(1)}{\psi_0(0)}\)</span>, representing the multiplicative contrast of an outcome between the counterfactuals under which all subjects received the treatment/exposure and under which none received such treatment/exposure. Under additional (untestable) assumptions, this parameter has a richer interpretation as a mean counterfactual outcome, wherein the counterfactuals used in this definition define causal effects. When causal assumptions remain unfulfilled or untested, this parameter may still be estimated in the form of a nonparametric VIM.</p>
<p>Just as before (in the case of the ATE), there are two regression steps required for estimating VIMs based on this parameter. We do so in a manner analogous to that described previously.</p>
<div id="super-learning-for-nonparametric-parameter-estimation-1" class="section level4">
<h4 class="hasAnchor">
<a href="#super-learning-for-nonparametric-parameter-estimation-1" class="anchor"></a>Super Learning for nonparametric parameter estimation</h4>
<p>Nonparametric and data-adaptive regressions (i.e., machine learning) may be used in the two regression steps required for estimating a VIM based on the RR. This is implemented using the Super Learner algorithm.</p>
<p><code>methyvim</code> makes performing such estimation for CpG sites using a given VIM essentially trivial:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">methyvim_rr_sl &lt;-<span class="st"> </span><span class="kw"><a href="../reference/methyvim.html">methyvim</a></span>(<span class="dt">data_grs =</span> grsExample, <span class="dt">sites_comp =</span> <span class="dv">25</span>,</a>
<a class="sourceLine" id="cb17-2" data-line-number="2">                            <span class="dt">var_int =</span> var_int, <span class="dt">vim =</span> <span class="st">"rr"</span>, <span class="dt">type =</span> <span class="st">"Mval"</span>,</a>
<a class="sourceLine" id="cb17-3" data-line-number="3">                            <span class="dt">filter =</span> <span class="st">"limma"</span>, <span class="dt">filter_cutoff =</span> <span class="fl">0.10</span>,</a>
<a class="sourceLine" id="cb17-4" data-line-number="4">                            <span class="dt">parallel =</span> <span class="ot">FALSE</span>, <span class="dt">tmle_type =</span> <span class="st">"sl"</span></a>
<a class="sourceLine" id="cb17-5" data-line-number="5">                           )</a></code></pre></div>
<pre><code>## Warning in set_parallel(parallel = parallel, future_param = future_param, :
## Sequential evaluation over many probes may take a long time.</code></pre>
<p>Just as before, we can take a look at the results produced from the estimation procedure (stored in the <code>vim</code> <code>slot</code> of the <code>methytmle</code> object) simply by invoking the custom S4 accessor function <code>vim</code> (note that the <code>show</code> method of the resultant object also displays this same information, amongst other things):</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="kw"><a href="../reference/methytmle-class.html">vim</a></span>(methyvim_rr_sl)</a></code></pre></div>
<pre><code>##                lwr_ci    est_logrr      upr_ci  var_logrr         pval
## cg22913481 -0.4092109 -0.157928211  0.09335450 0.01643664 0.2180100541
## cg15131207 -0.3866242 -0.132565211  0.12149379 0.01680185 0.3064465908
## cg10613282 -0.4609511 -0.209992283  0.04096657 0.01639430 0.1009949347
## cg15857610 -0.3912380 -0.122627974  0.14598203 0.01878158 0.3708967928
## cg24775884 -0.3001760 -0.012590429  0.27499517 0.02152891 0.9316187833
## cg22954484 -0.2096686  0.082632719  0.37493408 0.02224076 0.5795199112
## cg23076894 -0.3972518 -0.118400427  0.16045096 0.02024107 0.4052865289
## cg07697276 -0.4183878 -0.147105093  0.12417763 0.01915720 0.2878614482
## cg01674119 -0.5631423 -0.260549225  0.04204388 0.02383449 0.0914751160
## cg02749733 -0.3595319 -0.107507455  0.14451703 0.01653382 0.4031054760
## cg12742764 -0.7252065 -0.443645032 -0.16208358 0.02063641 0.0020130988
## cg15396367 -0.4854500 -0.195317164  0.09481569 0.02191198 0.1870119863
## cg18233010 -0.5963658 -0.310380117 -0.02439445 0.02129004 0.0334045380
## cg01532849 -0.4587578 -0.185399867  0.08795806 0.01945142 0.1837381017
## cg24268444 -0.6211676 -0.329263725 -0.03735987 0.02218031 0.0270459272
## cg10560245 -0.4215148 -0.156131854  0.10925108 0.01833301 0.2488610324
## cg20185936 -0.6060344 -0.325562935 -0.04509150 0.02047694 0.0228993370
## cg06714180 -0.7287084 -0.472424460 -0.21614047 0.01709743 0.0003026843
## cg15817960 -0.2907364 -0.005245429  0.28024557 0.02121645 0.9712729639
## cg15611151 -0.3362025 -0.106709841  0.12278280 0.01370962 0.3621037170
## cg00567703 -0.4298602 -0.162501535  0.10485717 0.01860701 0.2335379131
## cg01609275 -0.5015721 -0.240907053  0.01975800 0.01768697 0.0700735236
## cg00058576 -0.4121000 -0.130558355  0.15098334 0.02063352 0.3634007899
## cg26992600 -0.6375980 -0.328990324 -0.02038266 0.02479141 0.0366670157
## cg12172984 -0.2061964  0.055151896  0.31650019 0.01777981 0.6791556913
##            n_neighbors n_neighbors_control max_cor_neighbors
## cg22913481           0                   0                NA
## cg15131207           0                   0                NA
## cg10613282           0                   0                NA
## cg15857610           5                   4        0.77207047
## cg24775884           5                   2        0.88975664
## cg22954484           5                   2        0.86439358
## cg23076894           5                   1        0.88975664
## cg07697276           5                   2        0.84238389
## cg01674119           5                   5        0.61874408
## cg02749733           0                   0                NA
## cg12742764           8                   2        0.90569752
## cg15396367           8                   2        0.90569752
## cg18233010           8                   2        0.88601655
## cg01532849           8                   2        0.89423768
## cg24268444           8                   2        0.89690199
## cg10560245           8                   2        0.86644061
## cg20185936           8                   2        0.87376499
## cg06714180           8                   8       -0.09301902
## cg15817960           8                   8        0.40419875
## cg15611151           7                   7        0.13851867
## cg00567703           7                   7        0.13851867
## cg01609275           7                   7        0.20795189
## cg00058576           7                   4        0.88568207
## cg26992600           7                   4        0.85605741
## cg12172984           7                   4        0.87356095</code></pre>
</div>
<div id="generalized-linear-models-for-parameter-estimation-1" class="section level4">
<h4 class="hasAnchor">
<a href="#generalized-linear-models-for-parameter-estimation-1" class="anchor"></a>Generalized linear models for parameter estimation</h4>
<p>In cases where nonparametric regressions may not be preferred (e.g., where time constraints are of concern), generalized linear models (GLMs) may be used to fit the two regression steps required for estimating a VIMs for the ATE.</p>
<p><code>methyvim</code> makes performing such estimation for CpG sites using a given VIM essentially trivial:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1">methyvim_rr_glm &lt;-<span class="st"> </span><span class="kw"><a href="../reference/methyvim.html">methyvim</a></span>(<span class="dt">data_grs =</span> grsExample, <span class="dt">sites_comp =</span> <span class="dv">25</span>,</a>
<a class="sourceLine" id="cb21-2" data-line-number="2">                            <span class="dt">var_int =</span> var_int, <span class="dt">vim =</span> <span class="st">"rr"</span>, <span class="dt">type =</span> <span class="st">"Mval"</span>,</a>
<a class="sourceLine" id="cb21-3" data-line-number="3">                            <span class="dt">filter =</span> <span class="st">"limma"</span>, <span class="dt">filter_cutoff =</span> <span class="fl">0.10</span>,</a>
<a class="sourceLine" id="cb21-4" data-line-number="4">                            <span class="dt">parallel =</span> <span class="ot">FALSE</span>, <span class="dt">tmle_type =</span> <span class="st">"glm"</span></a>
<a class="sourceLine" id="cb21-5" data-line-number="5">                           )</a></code></pre></div>
<pre><code>## Warning in set_parallel(parallel = parallel, future_param = future_param, :
## Sequential evaluation over many probes may take a long time.</code></pre>
<p>Just as before, we can take a look at the results produced from the estimation procedure (stored in the <code>vim</code> <code>slot</code> of the <code>methytmle</code> object) simply by invoking the custom S4 accessor function <code>vim</code> (note that the <code>show</code> method of the resultant object also displays this same information, amongst other things):</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="kw"><a href="../reference/methytmle-class.html">vim</a></span>(methyvim_rr_glm)</a></code></pre></div>
<pre><code>##                lwr_ci    est_logrr      upr_ci  var_logrr         pval
## cg22913481 -0.4069465 -0.155520490  0.09590554 0.01645540 0.2253726279
## cg15131207 -0.3873508 -0.133384529  0.12058178 0.01678959 0.3032903444
## cg10613282 -0.4643026 -0.211461376  0.04137980 0.01664116 0.1011658212
## cg15857610 -0.4228660 -0.155410347  0.11204529 0.01862050 0.2547463475
## cg24775884 -0.3033120 -0.016800891  0.26971026 0.02136835 0.9084977837
## cg22954484 -0.2082032  0.086205045  0.38061331 0.02256253 0.5660332076
## cg23076894 -0.4000291 -0.121096780  0.15783558 0.02025283 0.3948126687
## cg07697276 -0.4239004 -0.152774774  0.11835081 0.01913502 0.2694077189
## cg01674119 -0.5602798 -0.261862697  0.03655444 0.02318117 0.0854486358
## cg02749733 -0.3663749 -0.114789703  0.13679545 0.01647623 0.3711715787
## cg12742764 -0.7247314 -0.442113551 -0.15949570 0.02079156 0.0021685034
## cg15396367 -0.5015719 -0.211841735  0.07788841 0.02185120 0.1518316990
## cg18233010 -0.6001598 -0.314071570 -0.02798334 0.02130531 0.0314198235
## cg01532849 -0.4735781 -0.194981413  0.08361524 0.02020411 0.1701428235
## cg24268444 -0.6319682 -0.339784180 -0.04760017 0.02222290 0.0226488361
## cg10560245 -0.4216809 -0.155147888  0.11138516 0.01849226 0.2539079346
## cg20185936 -0.6129249 -0.329697504 -0.04647011 0.02088134 0.0225139071
## cg06714180 -0.7220646 -0.464710184 -0.20735573 0.01724055 0.0004013234
## cg15817960 -0.2824709  0.002817598  0.28810607 0.02118636 0.9845558569
## cg15611151 -0.3524153 -0.119936485  0.11254236 0.01406872 0.3119353187
## cg00567703 -0.4340690 -0.167252518  0.09956395 0.01853161 0.2192158746
## cg01609275 -0.5099162 -0.246428433  0.01705934 0.01807211 0.0667875358
## cg00058576 -0.3969395 -0.111432402  0.17407468 0.02121884 0.4442828298
## cg26992600 -0.6417775 -0.332846224 -0.02391490 0.02484344 0.0347098769
## cg12172984 -0.2504724  0.014082907  0.27863817 0.01821884 0.9169031295
##            n_neighbors n_neighbors_control max_cor_neighbors
## cg22913481           0                   0                NA
## cg15131207           0                   0                NA
## cg10613282           0                   0                NA
## cg15857610           5                   4        0.77207047
## cg24775884           5                   2        0.88975664
## cg22954484           5                   2        0.86439358
## cg23076894           5                   1        0.88975664
## cg07697276           5                   2        0.84238389
## cg01674119           5                   5        0.61874408
## cg02749733           0                   0                NA
## cg12742764           8                   2        0.90569752
## cg15396367           8                   2        0.90569752
## cg18233010           8                   2        0.88601655
## cg01532849           8                   2        0.89423768
## cg24268444           8                   2        0.89690199
## cg10560245           8                   2        0.86644061
## cg20185936           8                   2        0.87376499
## cg06714180           8                   8       -0.09301902
## cg15817960           8                   8        0.40419875
## cg15611151           7                   7        0.13851867
## cg00567703           7                   7        0.13851867
## cg01609275           7                   7        0.20795189
## cg00058576           7                   4        0.88568207
## cg26992600           7                   4        0.85605741
## cg12172984           7                   4        0.87356095</code></pre>
<p><em>Remark:</em> Here, the estimates are obtained via GLMs, making each of the regression steps less robust than if nonparametric regressions were used. It is expected that these estimates differ from those obtained previously.</p>
<hr>
</div>
</div>
</div>
<div id="data-analysis-with-methyvim" class="section level2">
<h2 class="hasAnchor">
<a href="#data-analysis-with-methyvim" class="anchor"></a>Data Analysis with <code>methyvim</code>
</h2>
<p>In order to explore practical applications of the <code>methyvim</code> package, as well as the full set of utilities it provides, our toy example (of just <span class="math inline">\(10\)</span> CpG sites) is unfortunately insufficient. To proceed, we will use a publicly available example data set produced by the Illumina 450K array, from the <code>minfiData</code> R package. Now, let’s load the package and data set, and take a look</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/message.html">suppressMessages</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(minfiData))</a>
<a class="sourceLine" id="cb25-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(MsetEx)</a>
<a class="sourceLine" id="cb25-3" data-line-number="3">mset &lt;-<span class="st"> </span><span class="kw">mapToGenome</span>(MsetEx)</a>
<a class="sourceLine" id="cb25-4" data-line-number="4">grs &lt;-<span class="st"> </span><span class="kw">ratioConvert</span>(mset)</a>
<a class="sourceLine" id="cb25-5" data-line-number="5">grs</a></code></pre></div>
<pre><code>## class: GenomicRatioSet 
## dim: 485512 6 
## metadata(0):
## assays(2): Beta CN
## rownames(485512): cg13869341 cg14008030 ... cg08265308 cg14273923
## rowData names(0):
## colnames(6): 5723646052_R02C02 5723646052_R04C01 ...
##   5723646053_R05C02 5723646053_R06C02
## colData names(13): Sample_Name Sample_Well ... Basename filenames
## Annotation
##   array: IlluminaHumanMethylation450k
##   annotation: ilmn12.hg19
## Preprocessing
##   Method: Raw (no normalization or bg correction)
##   minfi version: 1.21.2
##   Manifest version: 0.4.0</code></pre>
<p>After loading the data, which comes in the form of a raw <code>MethylSet</code> object, we perform some further processing by mapping to the genome (with <code>mapToGenome</code>) and converting the values from the methylated and unmethylated channels to Beta-values (via <code>ratioConvert</code>). These two steps together produce an object of class <code>GenomicRatioSet</code>, like what we had worked with previously.</p>
<p>For this example analysis, we’ll treat the condition of the patients as the exposure/treatment variable of interest. The <code>methyvim</code> function requires that this variable either be <code>numeric</code> or easily coercible to <code>numeric</code>. To facilitate this, we’ll simply convert the covariate (currently a <code>character</code>):</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1">var_int &lt;-<span class="st"> </span>(<span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="kw">colData</span>(grs)<span class="op">$</span>status)) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb27-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/table.html">table</a></span>(var_int)</a></code></pre></div>
<pre><code>## var_int
## 0 1 
## 3 3</code></pre>
<p><strong>n.b.</strong>, the re-coding process results in “normal” patients being assigned a value of 1 and cancer patients a 0.</p>
<p>Now, we are ready to analyze the effects of cancer status on DNA methylation using this data set. To do this with a targeted minimum loss-based estimate of the Average Treatment Effect, we may proceed as follows:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/message.html">suppressMessages</a></span>(</a>
<a class="sourceLine" id="cb29-2" data-line-number="2">  methyvim_cancer_ate &lt;-<span class="st"> </span><span class="kw"><a href="../reference/methyvim.html">methyvim</a></span>(<span class="dt">data_grs =</span> grs, <span class="dt">var_int =</span> var_int,</a>
<a class="sourceLine" id="cb29-3" data-line-number="3">                                  <span class="dt">vim =</span> <span class="st">"ate"</span>, <span class="dt">type =</span> <span class="st">"Beta"</span>, <span class="dt">filter =</span> <span class="st">"limma"</span>,</a>
<a class="sourceLine" id="cb29-4" data-line-number="4">                                  <span class="dt">filter_cutoff =</span> <span class="fl">0.30</span>, <span class="dt">obs_per_covar =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb29-5" data-line-number="5">                                  <span class="dt">parallel =</span> <span class="ot">FALSE</span>, <span class="dt">sites_comp =</span> <span class="dv">50</span>,</a>
<a class="sourceLine" id="cb29-6" data-line-number="6">                                  <span class="dt">tmle_args =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">cv_folds =</span> <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb29-7" data-line-number="7">                                  <span class="dt">tmle_type =</span> <span class="st">"sl"</span></a>
<a class="sourceLine" id="cb29-8" data-line-number="8">                                 )</a>
<a class="sourceLine" id="cb29-9" data-line-number="9">)</a></code></pre></div>
<p>Note that we set the <code>obs_per_covar</code> argument to a relatively low value (2, where the recommended default is 20) for the purposes of this example as the sample size is only 10. We do this only to exemplify the estimation procedure and it is important to point out that such low values for <code>obs_per_covar</code> will compromise the quality of inference obtained because this setting directly affects the definition of the target parameter.</p>
<p>Further, note that here we apply the <code>glm</code> flavor of the <code>tmle_type</code> argument, which produces faster results by fitting models for the propensity score and outcome regressions using a limited number of parametric models. By contrast, the <code>sl</code> (for “Super Learning”) flavor fits these two regressions using highly nonparametric and data-adaptive procedures (i.e., via machine learning).</p>
<p>Let’s examine the table of results by examining the <code>methytmle</code> object that was produced by our call to the <code>methyvim</code> wrapper function:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1">methyvim_cancer_ate</a></code></pre></div>
<p>Finally, we may compute FDR-corrected p-values, by applying a modified procedure for controlling the False Discovery Rate for multi-stage analyses (FDR-MSA) <span class="citation">(Tuglus and van der Laan 2009)</span>. We do this by simply applying the <code>fdr_msa</code> function:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1">fdr_p &lt;-<span class="st"> </span><span class="kw"><a href="../reference/fdr_msa.html">fdr_msa</a></span>(<span class="dt">pvals =</span> <span class="kw"><a href="../reference/methytmle-class.html">vim</a></span>(methyvim_cancer_ate)<span class="op">$</span>pval,</a>
<a class="sourceLine" id="cb31-2" data-line-number="2">                 <span class="dt">total_obs =</span> <span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(methyvim_cancer_ate))</a></code></pre></div>
<p>Having explored the results of our analysis numerically, we now proceed to use the visualization tools provided with the <code>methyvim</code> R package to further enhance our understanding of the results.</p>
<div id="visualization-of-results" class="section level3">
<h3 class="hasAnchor">
<a href="#visualization-of-results" class="anchor"></a>Visualization of Results</h3>
<p>While making allowance for users to explore the full set of results produced by the estimation procedure (by way of exposing these directly to the user), the <code>methyvim</code> package also provides <em>three</em> (3) visualization utilities that produce plots commonly used in examining the results of differential methylation analyses.</p>
<p>A simple call to <code>plot</code> produces side-by-side histograms of the raw p-values computed as part of the estimation process and the corrected p-values obtained from using the FDR-MSA procedure.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(methyvim_cancer_ate)</a></code></pre></div>
<p><strong>Remark:</strong> The plots displayed above may also be generated separately by explicitly setting the argument “type” to <code>plot.methytmle</code>. For a plot of the raw p-values, specify <code>type = "raw_pvals"</code>, and for a plot of the FDR-corrected p-values, specify <code>type = "fdr_pvals"</code>.</p>
<p>While histograms of the p-values may be generally useful in inspecting the results of the estimation procedure, a more common plot used in examining the results of differential methylation procedures is the volcano plot, which plots the parameter estimate along the x-axis and <span class="math inline">\(-\text{log}_{10}(\text{p-value})\)</span> along the y-axis. We implement such a plot in the <code>methyvolc</code> function:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1"><span class="kw"><a href="../reference/methyvolc.html">methyvolc</a></span>(methyvim_cancer_ate)</a></code></pre></div>
<p>The purpose of such a plot is to ensure that very low (possibly statistically significant) p-values do not arise from cases of low variance. This appears to be the case in the plot above (notice that most parameter estimates are <em>near zero</em>, even in cases where the raw p-values are quite low).</p>
<p>Yet another popular plot for visualizing effects in such settings is the heatmap, which plots estimates of the raw methylation effects (as measured by the assay) across subjects using a heat gradient. We implement this in the <code>methyheat</code> function:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1"><span class="kw"><a href="../reference/methyheat.html">methyheat</a></span>(methyvim_cancer_ate)</a></code></pre></div>
<p>Invoking <code>methyheat</code> in this manner produces a plot of the top sites (<span class="math inline">\(25\)</span>, by default) based on the raw p-value, using the raw methylation measures in the plot. This uses the exceptional <code>superheat</code> R package <span class="citation">(Barter and Yu 2017)</span>.</p>
<hr>
</div>
</div>
<div id="session-information" class="section level2">
<h2 class="hasAnchor">
<a href="#session-information" class="anchor"></a>Session Information</h2>
<pre><code>## R version 3.6.1 (2019-07-05)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Ubuntu 18.04.3 LTS
## 
## Matrix products: default
## BLAS:   /usr/lib/x86_64-linux-gnu/openblas/libblas.so.3
## LAPACK: /usr/lib/x86_64-linux-gnu/libopenblasp-r0.2.20.so
## 
## locale:
##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            
## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
##  [1] splines   stats4    parallel  stats     graphics  grDevices utils    
##  [8] datasets  methods   base     
## 
## other attached packages:
##  [1] minfiData_0.30.0                                  
##  [2] IlluminaHumanMethylation450kanno.ilmn12.hg19_0.6.0
##  [3] IlluminaHumanMethylation450kmanifest_0.4.0        
##  [4] arm_1.10-1                                        
##  [5] lme4_1.1-21                                       
##  [6] MASS_7.3-51.4                                     
##  [7] earth_5.1.1                                       
##  [8] plotmo_3.5.6                                      
##  [9] TeachingDemos_2.10                                
## [10] plotrix_3.7-6                                     
## [11] Formula_1.2-3                                     
## [12] gam_1.16.1                                        
## [13] doFuture_0.8.2                                    
## [14] future_1.14.0                                     
## [15] globals_0.12.4                                    
## [16] methyvimData_1.6.0                                
## [17] methyvim_1.9.0                                    
## [18] minfi_1.30.0                                      
## [19] bumphunter_1.26.0                                 
## [20] locfit_1.5-9.1                                    
## [21] iterators_1.0.12                                  
## [22] Biostrings_2.52.0                                 
## [23] XVector_0.24.0                                    
## [24] SummarizedExperiment_1.14.1                       
## [25] DelayedArray_0.10.0                               
## [26] BiocParallel_1.18.1                               
## [27] matrixStats_0.55.0                                
## [28] Biobase_2.44.0                                    
## [29] GenomicRanges_1.36.1                              
## [30] GenomeInfoDb_1.20.0                               
## [31] IRanges_2.18.3                                    
## [32] S4Vectors_0.22.1                                  
## [33] BiocGenerics_0.30.0                               
## [34] tmle_1.4.0.1                                      
## [35] SuperLearner_2.0-25-9000                          
## [36] nnls_1.4                                          
## [37] glmnet_2.0-18                                     
## [38] foreach_1.4.7                                     
## [39] Matrix_1.2-17                                     
## [40] BiocStyle_2.12.0                                  
## 
## loaded via a namespace (and not attached):
##   [1] backports_1.1.5          plyr_1.8.4              
##   [3] lazyeval_0.2.2           listenv_0.7.0           
##   [5] ggplot2_3.2.1            digest_0.6.22           
##   [7] htmltools_0.4.0          magrittr_1.5            
##   [9] memoise_1.1.0            cluster_2.1.0           
##  [11] limma_3.40.6             readr_1.3.1             
##  [13] annotate_1.62.0          askpass_1.1             
##  [15] pkgdown_1.4.1            siggenes_1.58.0         
##  [17] prettyunits_1.0.2        colorspace_1.4-1        
##  [19] blob_1.2.0               xfun_0.10               
##  [21] dplyr_0.8.3              crayon_1.3.4            
##  [23] RCurl_1.95-4.12          genefilter_1.66.0       
##  [25] GEOquery_2.52.0          zeallot_0.1.0           
##  [27] survival_2.44-1.1        glue_1.3.1              
##  [29] registry_0.5-1           gtable_0.3.0            
##  [31] zlibbioc_1.30.0          superheat_0.1.0         
##  [33] Rhdf5lib_1.6.3           HDF5Array_1.12.3        
##  [35] abind_1.4-5              scales_1.0.0            
##  [37] DBI_1.0.0                rngtools_1.4            
##  [39] bibtex_0.4.2             Rcpp_1.0.2              
##  [41] xtable_1.8-4             progress_1.2.2          
##  [43] bit_1.1-14               mclust_5.4.5            
##  [45] preprocessCore_1.46.0    httr_1.4.1              
##  [47] RColorBrewer_1.1-2       pkgconfig_2.0.3         
##  [49] reshape_0.8.8            XML_3.98-1.20           
##  [51] tidyselect_0.2.5         rlang_0.4.1             
##  [53] AnnotationDbi_1.46.1     munsell_0.5.0           
##  [55] tools_3.6.1              RSQLite_2.1.2           
##  [57] evaluate_0.14            stringr_1.4.0           
##  [59] yaml_2.2.0               knitr_1.25              
##  [61] bit64_0.9-7              fs_1.3.1                
##  [63] beanplot_1.2             scrime_1.3.5            
##  [65] purrr_0.3.3              nlme_3.1-141            
##  [67] doRNG_1.7.1              nor1mix_1.3-0           
##  [69] xml2_1.2.2               biomaRt_2.40.5          
##  [71] compiler_3.6.1           tibble_2.1.3            
##  [73] stringi_1.4.3            GenomicFeatures_1.36.4  
##  [75] desc_1.2.0               lattice_0.20-38         
##  [77] nloptr_1.2.1             ggsci_2.9               
##  [79] multtest_2.40.0          vctrs_0.2.0             
##  [81] pillar_1.4.2             lifecycle_0.1.0         
##  [83] BiocManager_1.30.9       data.table_1.12.6       
##  [85] bitops_1.0-6             rtracklayer_1.44.4      
##  [87] R6_2.4.0                 bookdown_0.14           
##  [89] gridExtra_2.3            codetools_0.2-16        
##  [91] boot_1.3-23              gtools_3.8.1            
##  [93] assertthat_0.2.1         rhdf5_2.28.1            
##  [95] openssl_1.4.1            pkgmaker_0.27           
##  [97] rprojroot_1.3-2          withr_2.1.2             
##  [99] GenomicAlignments_1.20.1 Rsamtools_2.0.3         
## [101] GenomeInfoDbData_1.2.1   hms_0.5.2               
## [103] quadprog_1.5-7           grid_3.6.1              
## [105] coda_0.19-3              minqa_1.2.4             
## [107] tidyr_1.0.0              base64_2.0              
## [109] rmarkdown_1.16           DelayedMatrixStats_1.6.1
## [111] illuminaio_0.26.0</code></pre>
<hr>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references">
<div id="ref-aryee2014minfi">
<p>Aryee, Martin J, Andrew E Jaffe, Hector Corrada-Bravo, Christine Ladd-Acosta, Andrew P Feinberg, Kasper D Hansen, and Rafael A Irizarry. 2014. “Minfi: A Flexible and Comprehensive Bioconductor Package for the Analysis of Infinium DNA Methylation Microarrays.” <em>Bioinformatics</em> 30 (10). Oxford University Press (OUP): 1363–9. <a href="https://doi.org/10.1093/bioinformatics/btu049" class="uri">https://doi.org/10.1093/bioinformatics/btu049</a>.</p>
</div>
<div id="ref-barter2017superheat">
<p>Barter, Rebecca L, and Bin Yu. 2017. “Superheat: An R Package for Creating Beautiful and Extendable Heatmaps for Visualizing Complex Data.”</p>
</div>
<div id="ref-benjamini1995controlling">
<p>Benjamini, Yoav, and Yosef Hochberg. 1995. “Controlling the False Discovery Rate: A Practical and Powerful Approach to Multiple Testing.” <em>Journal of the Royal Statistical Society. Series B (Methodological)</em>. JSTOR, 289–300.</p>
</div>
<div id="ref-breiman1996stacked">
<p>Breiman, Leo. 1996. “Stacked Regressions.” <em>Machine Learning</em> 24 (1). Springer: 49–64.</p>
</div>
<div id="ref-chambaz2012estimation">
<p>Chambaz, Antoine, Pierre Neuvial, and Mark J van der Laan. 2012. “Estimation of a Non-Parametric Variable Importance Measure of a Continuous Exposure.” <em>Electronic Journal of Statistics</em> 6. NIH Public Access: 1059.</p>
</div>
<div id="ref-dedeurwaerder2013comprehensive">
<p>Dedeurwaerder, Sarah, Matthieu Defrance, Martin Bizet, Emilie Calonne, Gianluca Bontempi, and François Fuks. 2013. “A Comprehensive Overview of Infinium Humanmethylation450 Data Processing.” <em>Briefings in Bioinformatics</em>. Oxford Univ Press, bbt054.</p>
</div>
<div id="ref-fortin2014functional">
<p>Fortin, Jean-Philippe, Aurelie Labbe, Mathieu Lemire, Brent W Zanke, Thomas J Hudson, Elana J Fertig, Celia MT Greenwood, and Kasper D Hansen. 2014. “Functional Normalization of 450k Methylation Array Data Improves Replication in Large Cancer Studies.” <em>bioRxiv</em>. Cold Spring Harbor Labs Journals.</p>
</div>
<div id="ref-hernan2019causal">
<p>Hernan, Miguel A, and James M Robins. 2019. <em>Causal Inference</em>. Chapman &amp; Hall / CRC Texts in Statistical Science. Taylor &amp; Francis.</p>
</div>
<div id="ref-pearl2000causality">
<p>Pearl, Judea. 2000. <em>Causality: Models, Reasoning, and Inference</em>. Cambridge University Press.</p>
</div>
<div id="ref-robertson2005dna">
<p>Robertson, Keith D. 2005. “DNA Methylation and Human Disease.” <em>Nature Reviews. Genetics</em> 6 (8). Nature Publishing Group: 597.</p>
</div>
<div id="ref-tuglus2009modified">
<p>Tuglus, Catherine, and Mark J van der Laan. 2009. “Modified FDR Controlling Procedure for Multi-Stage Analyses.” <em>Statistical Applications in Genetics and Molecular Biology</em> 8 (1). Walter de Gruyter: 1–15. <a href="https://doi.org/10.2202/1544-6115.1397" class="uri">https://doi.org/10.2202/1544-6115.1397</a>.</p>
</div>
<div id="ref-vdl2007super">
<p>van der Laan, Mark J, Eric C Polley, and Alan E Hubbard. 2007. “Super Learner.” <em>Statistical Applications in Genetics and Molecular Biology</em> 6 (1).</p>
</div>
<div id="ref-vdl2011targeted">
<p>van der Laan, Mark J, and Sherri Rose. 2011. <em>Targeted Learning: Causal Inference for Observational and Experimental Data</em>. Springer Science &amp; Business Media.</p>
</div>
<div id="ref-vdl2018targeted">
<p>———. 2018. <em>Targeted Learning in Data Science: Causal Inference for Complex Longitudinal Studies</em>. Springer Science &amp; Business Media.</p>
</div>
<div id="ref-wolpert1992stacked">
<p>Wolpert, David H. 1992. “Stacked Generalization.” <em>Neural Networks</em> 5 (2). Springer: 241–59.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#methodology">Methodology</a></li>
      <li><a href="#parameters-of-interest">Parameters of Interest</a></li>
      <li><a href="#preliminaries-setting-up-the-data">Preliminaries: Setting up the Data</a></li>
      <li><a href="#differential-methylation-based-on-a-binary-treatment-or-exposure">Differential Methylation Based on a Binary Treatment or Exposure</a></li>
      <li><a href="#data-analysis-with-methyvim">Data Analysis with <code>methyvim</code></a></li>
      <li><a href="#session-information">Session Information</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Nima Hejazi, Mark van der Laan.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
