<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Differential Methylation Statistics with Variable Importance Measures — methyvim • methyvim</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Differential Methylation Statistics with Variable Importance Measures — methyvim" />

<meta property="og:description" content="Computes the Targeted Minimum Loss-Based Estimate of a specified statistical
target parameter, formally defined within models from causal inference. The
variable importance measures currently supported are the Average Treatment
Effect (ATE) and a Nonparametric Variable Importance Measure (NPVI, formally
defined by Chambaz, Neuvial, and van der Laan &amp;lt;doi:10.1214/12-EJS703&amp;gt;)." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">methyvim</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.5.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/using_methyvim.html">Targeted Data-Adaptive Estimation and Inference for Differential Methylation Analysis</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/nhejazi/methyvim">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Differential Methylation Statistics with Variable Importance Measures</h1>
    <small class="dont-index">Source: <a href='https://github.com/nhejazi/methyvim/blob/master/R/methyvim.R'><code>R/methyvim.R</code></a></small>
    <div class="hidden name"><code>methyvim.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Computes the Targeted Minimum Loss-Based Estimate of a specified statistical
target parameter, formally defined within models from causal inference. The
variable importance measures currently supported are the Average Treatment
Effect (ATE) and a Nonparametric Variable Importance Measure (NPVI, formally
defined by Chambaz, Neuvial, and van der Laan &lt;doi:10.1214/12-EJS703&gt;).</p>
    
    </div>

    <pre class="usage"><span class='fu'>methyvim</span>(<span class='no'>data_grs</span>, <span class='no'>var_int</span>, <span class='kw'>vim</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"ate"</span>, <span class='st'>"rr"</span>, <span class='st'>"npvi"</span>),
  <span class='kw'>type</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"Beta"</span>, <span class='st'>"Mval"</span>), <span class='kw'>filter</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"limma"</span>),
  <span class='kw'>filter_cutoff</span> <span class='kw'>=</span> <span class='fl'>0.05</span>, <span class='kw'>window_bp</span> <span class='kw'>=</span> <span class='fl'>1000</span>, <span class='kw'>corr_max</span> <span class='kw'>=</span> <span class='fl'>0.75</span>,
  <span class='kw'>obs_per_covar</span> <span class='kw'>=</span> <span class='fl'>20</span>, <span class='kw'>sites_comp</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>parallel</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>future_param</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>bppar_type</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>return_ic</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>shrink_ic</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>tmle_type</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"glm"</span>, <span class='st'>"sl"</span>),
  <span class='kw'>tmle_args</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>family</span> <span class='kw'>=</span> <span class='st'>"binomial"</span>, <span class='kw'>g_lib</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"SL.mean"</span>, <span class='st'>"SL.glm"</span>,
  <span class='st'>"SL.bayesglm"</span>, <span class='st'>"SL.gam"</span>), <span class='kw'>Q_lib</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"SL.mean"</span>, <span class='st'>"SL.glm"</span>, <span class='st'>"SL.gam"</span>,
  <span class='st'>"SL.earth"</span>), <span class='kw'>npvi_cutoff</span> <span class='kw'>=</span> <span class='fl'>0.25</span>, <span class='kw'>npvi_descr</span> <span class='kw'>=</span> <span class='kw'>NULL</span>),
  <span class='kw'>tmle_backend</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"tmle"</span>, <span class='st'>"drtmle"</span>, <span class='st'>"tmle.npvi"</span>))</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data_grs</th>
      <td><p>An object of class <code><a href='https://www.rdocumentation.org/packages/minfi/topics/GenomicRatioSet-class'>minfi::GenomicRatioSet</a></code>, containing
standard data structures associated with DNA Methylation experiments.
Consult the documentation for <code>minfi</code> to construct such objects.</p></td>
    </tr>
    <tr>
      <th>var_int</th>
      <td><p>A <code>numeric</code> vector containing subject-level measurements
of the variable of interest. The length of this vector must match the
number of subjects exactly. If argument <code>vim</code> is set to "ate" or "rr",
then the variable of interest is treated as an exposure, and the variable
must be binary in such cases. If setting <code>vim</code> to target parameters
assessing continuous treatment effects, then the variable need not be binary
of course.</p></td>
    </tr>
    <tr>
      <th>vim</th>
      <td><p>Character indicating the variable importance measure to be used in
the estimation procedure. Currently supported options are the ATE for
discretized exposures and NPVI for continuous exposures. ATE and RR are the
appropriate choices when the underlying scientific question is of the effect
of an exposure on methylation, while NPVI (and other continuous treatment
parameters) ought to be used when the effect of methylation on an outcome is
sought.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>Character indicating the particular measure of DNA methylation to
be used as the observed data in the estimation procedure, either Beta values
or M-values. The data are accessed via <code><a href='https://www.rdocumentation.org/packages/minfi/topics/MethylSet-class'>minfi::getBeta</a></code> or
<code><a href='https://www.rdocumentation.org/packages/minfi/topics/MethylSet-class'>minfi::getM</a></code>.</p></td>
    </tr>
    <tr>
      <th>filter</th>
      <td><p>Character indicating the model to be implemented when screening
the <code>data_grs</code> object for CpG sites. The only currently supported
option is "limma". Contributions for other methods are welcome.</p></td>
    </tr>
    <tr>
      <th>filter_cutoff</th>
      <td><p>Numeric indicating the p-value cutoff that defines which
sites pass through the <code>filter</code>.</p></td>
    </tr>
    <tr>
      <th>window_bp</th>
      <td><p>Numeric indicating the maximum genomic distance (in base
pairs) between two sites for them to be considered neighboring sites.</p></td>
    </tr>
    <tr>
      <th>corr_max</th>
      <td><p>Numeric indicating the maximum correlation that a neighboring
site can have with the target site.</p></td>
    </tr>
    <tr>
      <th>obs_per_covar</th>
      <td><p>Numeric indicating the number of observations needed for
for covariate included in W for downstream analysis. This ensures the data
is sufficient to control for the covariates.</p></td>
    </tr>
    <tr>
      <th>sites_comp</th>
      <td><p>A <code>numeric</code> indicating the maximum number of sites for
which a variable importance measure is to be estimated post-screening. This
is not typically useful in scientific settings, but may be useful when a
large number of CpG sites pass the initial screening phase.</p></td>
    </tr>
    <tr>
      <th>parallel</th>
      <td><p>Logical indicating whether parallelization ought to be used.
See the documentation of <code>set_parallel</code> for more information, as this
argument is passed directly to that internal function.</p></td>
    </tr>
    <tr>
      <th>future_param</th>
      <td><p>Character indicating the type of parallelization to be
used from the list available via the <code>future</code> package. See the
documentation for <code>set_parallel</code> for more information, as this argument
is passed directly to that internal function.</p></td>
    </tr>
    <tr>
      <th>bppar_type</th>
      <td><p>Character specifying the type of backend to be used for
parallelization via <code>BiocParallel</code>. See the documentation for
<code>set_parallel</code> for more information, as this argument is passed
directly to that internal function.</p></td>
    </tr>
    <tr>
      <th>return_ic</th>
      <td><p>Logical indicating whether an influence curve estimate
should be returned for each site that passed through the filter.</p></td>
    </tr>
    <tr>
      <th>shrink_ic</th>
      <td><p>Logical indicating whether limma should be applied to reduce
the variance in the ic based estimates in <code>return_ic</code>.</p></td>
    </tr>
    <tr>
      <th>tmle_type</th>
      <td><p>Character indicating the general class of regression models
to be used in fitting the propensity score and outcome regressions. This is
generally a shorthand and is overridden by <code>tmle_args</code> if that argument
is changed from its default values.</p></td>
    </tr>
    <tr>
      <th>tmle_args</th>
      <td><p>List giving several key arguments to be passed to one of
<code><a href='https://www.rdocumentation.org/packages/tmle/topics/tmle'>tmle::tmle</a></code> or <code>tmle.npvi::tmle.npvi</code>, depending on the
particular variable importance measure specified. This overrides
<code>tmle_type</code>, which itself provides sensible defaults. Consider changing
this away from default settings only if you have sufficient experience with
software and the underlying theory for Targeted Learning. For more
information, consider consulting the documentation of the <code>tmle</code> and
<code>tmle.npvi</code> packages.</p></td>
    </tr>
    <tr>
      <th>tmle_backend</th>
      <td><p>A <code>character</code> indicating the package to be used in
the estimation procedure. The user should only set this parameter if they
have sufficient familiarity with the backend packages used for estimation.
Current choices include <code>tmle</code>, <code>drtmle</code>, and <code>tmle.npvi</code>.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <code>methytmle</code>, with all unique slots filled in,
 in particular, including indices of CpG sites that pass screening, cluster
 of neighboring CpG sites, and a matrix of the results of the estimation
 procedure performed for the given variable importance measure. Optionally,
 estimates of the propensity score and outcome regressions, as well as the
 original data rotated into influence curve space may be returned, if so
 requested.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span>(<span class='no'>methyvimData</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/message'>suppressMessages</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span>(<span class='no'>SummarizedExperiment</span>))
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>grsExample</span>)
<span class='no'>var_int</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/SummarizedExperiment/topics/SummarizedExperiment-class'>colData</a></span>(<span class='no'>grsExample</span>)[, <span class='fl'>1</span>]
<span class='co'># TMLE procedure for the ATE parameter over M-values with Limma filtering</span>
<span class='no'>methyvim_out_ate</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/warning'>suppressWarnings</a></span>(
  <span class='fu'>methyvim</span>(
    <span class='kw'>data_grs</span> <span class='kw'>=</span> <span class='no'>grsExample</span>, <span class='kw'>sites_comp</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>var_int</span> <span class='kw'>=</span> <span class='no'>var_int</span>,
    <span class='kw'>vim</span> <span class='kw'>=</span> <span class='st'>"ate"</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"Mval"</span>, <span class='kw'>filter</span> <span class='kw'>=</span> <span class='st'>"limma"</span>, <span class='kw'>filter_cutoff</span> <span class='kw'>=</span> <span class='fl'>0.05</span>,
    <span class='kw'>parallel</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>tmle_type</span> <span class='kw'>=</span> <span class='st'>"sl"</span>
  )
)</div><div class='output co'>#&gt; <span class='message'>Loading required package: gam</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: splines</span></div><div class='output co'>#&gt; <span class='message'>Loaded gam 1.16</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: earth</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: Formula</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: plotmo</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: plotrix</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: TeachingDemos</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: arm</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: MASS</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: Matrix</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘Matrix’</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from ‘package:S4Vectors’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    expand</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: lme4</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>arm (Version 1.10-1, built: 2018-4-12)</span></div><div class='output co'>#&gt; <span class='message'>Working directory is /home/nsh/git/methyvim/docs/reference</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘arm’</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from ‘package:plotrix’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    rescale</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Nima Hejazi, Mark van der Laan.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

